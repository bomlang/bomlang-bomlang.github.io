---
layout: post
title: ë¡œê·¸ì¸ê´€ë ¨ ì‹œë„ ê¸€(ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì™€ ì¿ í‚¤ ì¥ë‹¨ì )
tag: Login, Session Storage, Cookie, Local Storage, project
---

# ë¡œê·¸ì¸ê´€ë ¨ ì‹œë„ ê¸€(ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì™€ ì¿ í‚¤ ì¥ë‹¨ì )

## 1. ê°œìš”

â€˜ë¡œìŠ¤íŠ¸ì•„í¬ ìˆ™ì œì²´í¬â€™ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤. ì—¬ëŸ¬ ê¸°ëŠ¥ì´ ë“¤ì–´ê°”ì§€ë§Œ, ê·¸ ì¤‘ ê°€ì¥ ê³ ë¯¼í–ˆë˜ ë¶€ë¶„ì€ ë¡œê·¸ì¸ì„ ì–´ë–»ê²Œ êµ¬í˜„í•˜ëŠ”ê°€ì— ëŒ€í•œ ë¬¸ì œì˜€ë‹¤. ì´ë²ˆì— ë‚´ê°€ ê³ ë¯¼í–ˆë˜ ë°©ë²•ê³¼ ì‹œí–‰ì°©ì˜¤, ë˜ í˜„ì—…ì—ì„œëŠ” ì–´ë–¤ë°©ì‹ìœ¼ë¡œ ì´ëŸ¬í•œ ë¬¸ì œë“¤ì„ í’€ì–´ê°€ëŠ”ì§€ì— ëŒ€í•œ ê¸€ì„ ì¨ë³´ë ¤ê³ í•œë‹¤.

## 2. ë¬¸ì œì ê³¼ í•´ê²°ë°©ë²•ì— ëŒ€í•œ ê³ ë¯¼

â€˜ë¡œìŠ¤íŠ¸ì•„í¬ ìˆ™ì œì²´í¬â€™ ì›¹ì‚¬ì´íŠ¸ëŠ” Supabaseë¥¼ ì‚¬ìš©í•˜ì—¬ ë§Œë“¤ì–´ì¡Œë‹¤. Supabaseì—ì„œëŠ” Authenticationê¸°ëŠ¥ë„ ì œê³µí•˜ê¸°ì— í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ê°œë°œì„ ì§„í–‰í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.

ë¨¼ì € ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë©´ì„œ ì½”ë“œë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í• ê¹Œì— ëŒ€í•œ ìƒê°ì„ í•˜ì˜€ë‹¤.

1. ì‚¬ìš©ìê°€ íšŒì›ê°€ì…ì„ í•˜ë©´ userë¼ëŠ” í…Œì´ë¸”ì— ì‚¬ìš©ìì˜ uuidì™€ í•¨ê»˜ ì‚¬ìš©ìê°€ íšŒì›ê°€ì…ì‹œ ì…ë ¥í–ˆë˜ ì •ë³´ë¥¼ í† ëŒ€ë¡œ í…Œì´ë¸”ì—´ì´ ìƒì„±ëœë‹¤.
2. íšŒì›ê°€ì…ì„ ì™„ë£Œí•œ ì‚¬ìš©ìê°€ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ Supabaseì—ì„œ ë°˜í™˜ë˜ëŠ” Access_tokenì„ ì €ì¥í•˜ê³ , Refresh_tokenì„ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ìë¥¼ ì²´í¬í•œë‹¤.

ì´ì •ë„ê°€ ë¨¼ì € ìƒê°í•´ë³¸ ë¡œê·¸ì¸ì— ê´€ë ¨í•œ ì½”ë“œ êµ¬ì„±ì´ì—ˆë‹¤. ë¬¸ì œëŠ” Access_tokenì„ ì–´ë””ì— ì €ì¥í•˜ëŠ”ì§€ì— ê´€í•œ ë¬¸ì œì˜€ë‹¤.

### ğŸ¤”Â í† í°ì„ ì–´ë””ì— ì €ì¥í• ê¹Œ?

í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì €ì¥ê³µê°„ì€ 3ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.

1. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ (Local Storage)
2. ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ (Session Storage)
3. ì¿ í‚¤ (Cookie)

### ë¡œì»¬ ìŠ¤í† ë¦¬ì§€

ë¶€íŠ¸ìº í”„ì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í• ë•Œ ì•„ë¬´ëŸ° ìƒê°ì—†ì´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì‚¬ìš©ìì— ëŒ€í•œ ë°ì´í„°ë¥¼ ë‹´ì•„ì„œ ë¬´ì§€ì„±ìœ¼ë¡œ ì‚¬ìš©í–ˆë˜ ê²½í—˜ì´ ìˆë‹¤. í”„ë¡œì íŠ¸ ì´í›„ ì•„ë¬´ë¦¬ ìƒê°í•´ë„ ë¡œì»¬ì— ë„£ìœ¼ë©´ ê³„ì†í•´ì„œ ì‚¬ìš©ìì— ëŒ€í•œ ì •ë³´ê°€ ë‚¨ê¸°ì— ë³´ì•ˆì— ì·¨ì•½í•˜ê³  ì¢‹ì§€ì•Šë‹¤ëŠ” ìƒê°ì„ ê°€ì§€ê³ ìˆì—ˆë‹¤.

- **ì¥ì **: ì‚¬ìš©ì´ ê°„í¸í•˜ê³ , í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì‰½ê²Œ ì ‘ê·¼ ê°€ëŠ¥.
- **ë‹¨ì **: XSS ê³µê²©ì— ì·¨ì•½í•˜ì—¬ ë³´ì•ˆì— ì·¨ì•½í•  ìˆ˜ ìˆìŒ.

### ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€

ì´ë²ˆ â€˜ë¡œìŠ¤íŠ¸ì•„í¬ ìˆ™ì œì²´í¬â€™ ì›¹í˜ì´ì§€ì— ëŒ€í•œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë©´ì„œ ì²˜ìŒìœ¼ë¡œ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¥¼ ì ìš©í•´ë³´ìëŠ” ìƒê°ì´ì—ˆë‹¤. ë¨¼ì € ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì˜ ì¥ì ìœ¼ë¡œ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì™€ ë‹¤ë¥´ê²Œ í•´ë‹¹ ë¸Œë¼ìš°ì €ì˜ ì°½ì„ ë‹«ìœ¼ë©´ ì„¸ì…˜ ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ ì‚­ì œë˜ê¸°ì— ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë³´ë‹¤ ë³´ì•ˆìƒìœ¼ë¡œ ë¹„êµì  ì•ˆì „í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤.

- **ì¥ì **: ë¸Œë¼ìš°ì € íƒ­ì´ ë‹«íˆë©´ ìë™ìœ¼ë¡œ ë°ì´í„°ê°€ ì‚­ì œë¨.
- **ë‹¨ì **: ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì™€ ë§ˆì°¬ê°€ì§€ë¡œ XSS ê³µê²©ì— ì·¨ì•½.

ì‚¬ìš©í›„ê¸° : ì¿ í‚¤ì™€ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ ë‘ê°œ ì¤‘ ê³ ë¯¼í•˜ë©´ì„œ ê²°ê³¼ì ìœ¼ë¡œ ì„¸ì…˜ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆë‹¤.
ì‚¬ìš©ë°©ë²• ìì²´ëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì™€ ë³„ë°˜ ë‹¤ë¥¼ê±°ì—†ì´ `sessionStorage.setItem`ì„ ì‚¬ìš©í•˜ì—¬ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ê°’ì„ ì €ì¥í•˜ê³  ê°€ì ¸ì™€ ì‚¬ìš©í•˜ë©´ ë˜ëŠ” ë°©ë²•ì´ì—ˆë‹¤.

### ì¿ í‚¤

ì¿ í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì´ë²ˆì´ ì²˜ìŒì´ì—ˆë‹¤. `react-cookie` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ í‚¤ë¥¼ ì‰½ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆì—ˆë‹¤. ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ ì¿ í‚¤ë¥¼ ì„¤ì •í•˜ê³  ê°’ì„ ì €ì¥í•˜ëŠ” ë°ëŠ” í° ë¬¸ì œê°€ ì—†ì—ˆë‹¤.

í•˜ì§€ë§Œ ì´ë²ˆì— ì¿ í‚¤ ëŒ€ì‹  ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í•œ ì´ìœ ê°€ ìˆë‹¤.

â†’ ë³´í†µ ë¡œê·¸ì¸ ì‹œìŠ¤í…œì„ êµ¬í˜„í•  ë•Œ ì¿ í‚¤ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤. ì¿ í‚¤ì— ì €ì¥ëœ í† í° ê°’ì„ HTTP ìš”ì²­ì˜ í—¤ë”ì— í¬í•¨ì‹œì¼œ ì¸ì¦ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹ì´ ì¼ë°˜ì ì´ë‹¤. ê·¸ëŸ¬ë‚˜ ë¡œê·¸ì¸ ì‹œìŠ¤í…œì€ í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ëª¨ë‘ì—ì„œ ì²˜ë¦¬ë˜ì–´ì•¼ í•˜ëŠ” ë³µí•©ì ì¸ ë¬¸ì œì´ë‹¤. í”„ë¡ íŠ¸ì—”ë“œë§Œ ê°œë°œí•˜ëŠ” ì…ì¥ì—ì„œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•´ ë¡œê·¸ì¸ì„ ê´€ë¦¬í• ì§€, ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í• ì§€ ê³ ë¯¼ì´ ë§ì•˜ë‹¤. ë°±ì—”ë“œê°€ ì—†ëŠ” ìƒí™©ì—ì„œëŠ” ì–´ëŠ ìª½ì„ ì‚¬ìš©í•˜ë”ë¼ë„ ì™„ì „í•œ ì¸ì¦ ì‹œìŠ¤í…œì„ êµ¬í˜„í•˜ê¸°ëŠ” ì–´ë µë‹¤ëŠ” ëŠë‚Œì„ ë°›ì•˜ë‹¤.

ì¿ í‚¤ì™€ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì˜ ì°¨ì´ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤:

- **ì¿ í‚¤**:
  - ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ HTTP ìš”ì²­ ë° ì‘ë‹µì—ì„œ ìë™ìœ¼ë¡œ ì „ì†¡ëœë‹¤.
  - ë³´ì•ˆ ì„¤ì •ì„ í†µí•´ HttpOnly, Secure ë“±ì˜ ì†ì„±ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.
  - ë§Œë£Œ ì‹œê°„ì„ ì„¤ì •í•˜ì—¬ ì˜êµ¬ì  ë˜ëŠ” ì¼ì‹œì ìœ¼ë¡œ ì €ì¥í•  ìˆ˜ ìˆë‹¤.
- **ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€**:
  - ë¸Œë¼ìš°ì € ì„¸ì…˜ì´ ì¢…ë£Œë˜ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§„ë‹¤.
  - ì„œë²„ì™€ ìë™ìœ¼ë¡œ ì „ì†¡ë˜ì§€ ì•Šìœ¼ë©°, í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.
  - ì‚¬ìš©ì´ ê°„í¸í•˜ë©°, ë³´ì•ˆì´ ìƒëŒ€ì ìœ¼ë¡œ ë†’ì€ ì •ë³´ë¥¼ ì €ì¥í•˜ê¸°ì—ëŠ” ì í•©í•˜ì§€ ì•Šë‹¤.
  -

ì´ë²ˆì— ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•œ ì´ìœ ëŠ” ì´ë²ˆ í† ì´ í”„ë¡œì íŠ¸ê°€ ë¡œê·¸ì¸ì„ ìš”êµ¬í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì‚¬ìš©ìë¥¼ êµ¬ë¶„í•˜ëŠ” ê°„ë‹¨í•œ ì‹œìŠ¤í…œì´ í•„ìš”í–ˆê¸° ë•Œë¬¸ì´ë‹¤. ë˜í•œ ì‚¬ìš©ìê°€ ì£¼ë¡œ ì£¼ë³€ ì¹œêµ¬ë“¤ì´ë¼ëŠ” ì ì„ ê³ ë ¤í•˜ì—¬, ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì ì ˆí•˜ë‹¤ê³  íŒë‹¨í–ˆë‹¤.

## ì¶”ê°€ì ìœ¼ë¡œ ì•Œê²Œ ëœ ì 

ì‚¬ì‹¤ ì¿ í‚¤ë„ ê·¸ëƒ¥ ì„¤ì •í•˜ê³  ê°’ì„ ì €ì¥í•˜ê³  í´ë¼ì´ì–¸íŠ¸ë‹¨ì—ì„œ ê°€ì ¸ë‹¤ ì“°ë©´ ë˜ëŠ”ì¤„ ì•Œì•˜ë‹¤. ê·¼ë° ì‹œë‹ˆì–´ê°œë°œìë¶„ê³¼ ë¡œê·¸ì¸ì— ê´€í•´ì„œ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë‹¤ë³´ë‹ˆ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì¸¡ì—ì„œ ì ‘ê·¼í•˜ì§€ ëª»í•˜ê²Œ ë§‰ëŠ”ë‹¤ê³  í•œë‹¤.

**HttpOnly**: í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScriptì—ì„œ ì¿ í‚¤ì— ì ‘ê·¼í•˜ì§€ ëª»í•˜ë„ë¡ ì„¤ì •.

ê·¸ ì´ìœ ëŠ” ë³´ì•ˆì´ìŠˆ ë•Œë¬¸ì´ë‹¤.

1. XSS
   - í´ë¼ì´ì–¸íŠ¸ ë¸Œë¼ìš°ì €ì— JavaScript ë¥¼ ì‚½ì…í•´ ì‹¤í–‰í•˜ëŠ” ê³µê²©
     - ê³µê²©ìì˜ ì½”ë“œê°€ ë‚´ ì‚¬ì´íŠ¸ì˜ ë¡œì§ì¸ ì²™ í–‰ë™í•  ìˆ˜ ìˆë‹¤.
2. CSRF
   - ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì—ì„œ ìš°ë¦¬ ì‚¬ì´íŠ¸ì˜ api ì½œì„ ìš”ì²­í•´ ì‹¤í–‰í•˜ëŠ” ê³µê²©
     - ë¡œê·¸ì¸í•œ ì²™ ê³„ì¢Œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë°”ê¾¸ê±°ê°€ ì†¡ê¸ˆì„ ë³´ë‚¸ë‹¤.

ë˜í•œ **Secure** ì†ì„±ì´ ìˆëŠ”ë°, ì´ ì†ì„±ë„ ë³´ì•ˆì„ ìœ„í•´ì„œ ì¤‘ìš”í•œ ì†ì„±ì´ë¼ê³  í•œë‹¤.

**Secure**: ì¿ í‚¤ë¥¼ HTTPSë¥¼ í†µí•´ì„œë§Œ ì „ì†¡.

## í˜„ì¬ êµ¬í˜„í•œ ë¡œì§

```js
export const signinUser = async (email: string, password: string) => {
  try {
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password,
    });

    if (error) {
      console.error("ë¡œê·¸ì¸ ì˜¤ë¥˜ :", error);
      return { success: false, error };
    } else {
      sessionStorage.setItem("userToken", data.session.refresh_token);
      useAuthStore.getState().setUserToken(data.session.access_token);
    }

    return { success: true, data };
  } catch (error) {
    console.error("ë¡œê·¸ì¸ ì¤‘ ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤.", error);
    return { success: false, error };
  }
};
```

Supabaseì—ì„œ ë¡œê·¸ì¸ì„ í•˜ê³  ë°›ì•„ì˜¨ JWTì—ì„œ access_tokenì€ ì „ì—­ìƒíƒœë¡œ ì €ì¥í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë‹¨ì—ì„œ ë³´ì´ì§€ì•Šê²Œ í•œë‹¤.

ê·¸ë¦¬ê³  refresh_tokenì„ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê³ , ì‚¬ìš©ìê°€ ìš”ì²­ì„ í•  ê²½ìš° access_tokenê³¼ refresh_tokenì„ ê°€ì ¸ì™€ ì ì ˆíˆ ì‚¬ìš©í•œë‹¤.

## ë§ˆì¹˜ë©°

ë¡œê·¸ì¸ì— ëŒ€í•œ ë¡œì§ì´í•´ê°€ ì•„ì§ê¹Œì§€ë„ ë§ì´ ë¶€ì¡±í•˜ë‹¤ê³  ìƒê°í•œë‹¤. ê°œë°œìê°€ ë˜ê¸° ìœ„í•´ì„œëŠ” ê¼­ í•„ìš”í•œ ì§€ì‹ì´ë¼ ìƒê°ëœë‹¤. ì´ë²ˆì„ ê¸°íšŒë¡œ ê³µë¶€í•˜ê¸°ë¡œ ë‹¤ì§í–ˆë‹¤.

ì´í›„ ë¡œê·¸ì¸ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œ ë‹¤ë¤„ë³´ë„ë¡ í•˜ê² ë‹¤.
